# TrustFlow Attestation Scripts

This directory contains two independent scripts for TrustFlow TDX attestation:

## 1. Report Generation Script (`generate_attestation_report.py`)

Generates TDX attestation reports that can be used for verification.

### Usage
```bash
# Generate report with random user data and save to file
python3 generate_attestation_report.py --output report.json

# Generate report with specific user data
python3 generate_attestation_report.py --user-data "abcd1234..." --output report.json

# Generate report with custom TEE identity
python3 generate_attestation_report.py --tee-identity "my_tdx_instance" --output report.json

# Generate report and print to stdout
python3 generate_attestation_report.py

# Enable verbose logging
python3 generate_attestation_report.py --output report.json --verbose
```

### Arguments
- `--user-data`: Hex string user data (32 bytes, 64 hex characters)
- `--tee-identity`: TEE identity string (default: "tdx_instance")
- `--report-type`: Type of report to generate (default: "Passport")
- `--output` / `-o`: Output file path for the generated report
- `--verbose` / `-v`: Enable verbose logging

## 2. Report Verification Script (`verify_attestation_report.py`)

Verifies TDX attestation reports generated by the report generation script.

### Usage
```bash
# Verify report with user data from the report itself
python3 verify_attestation_report.py report.json

# Verify report with specific user data
python3 verify_attestation_report.py report.json --user-data "abcd1234..."

# Verify with custom TEE platform
python3 verify_attestation_report.py report.json --tee-platform "TDX"

# Enable verbose logging
python3 verify_attestation_report.py report.json --verbose
```

### Arguments
- `report_file`: Path to the attestation report file (required)
- `--user-data`: Hex string user data to verify against (optional)
- `--tee-platform`: TEE platform to verify against (default: "TDX")
- `--verbose` / `-v`: Enable verbose logging

## Usage Example

### Environment 1: Generate Report
```bash
# Generate a report with specific user data
python3 generate_attestation_report.py \
    --user-data "1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef" \
    --output my_report.json
```

### Environment 2: Verify Report
```bash
# Copy the report to the verification environment and verify it
python3 verify_attestation_report.py my_report.json --user-data "1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef"
```

## Dependencies

Both scripts require the TrustFlow attestation modules:
- `trustflow.attestation.generation` (for report generation)
- `trustflow.attestation.verification` (for report verification)
- `trustflow.attestation.common` (common types and utilities)

## Key Features

- **Independent Operation**: Each script can run in separate environments
- **Flexible Input**: Support for custom user data and TEE parameters
- **File I/O**: Save reports to files or output to stdout
- **Error Handling**: Comprehensive error handling and logging
- **Command Line Interface**: Easy-to-use CLI with helpful arguments

## Notes

- User data should be 64 hex characters (32 bytes)
- Reports are saved in JSON format for easy transfer between environments
- The verification script can extract user data from the report if not provided
- Both scripts include proper logging for debugging and monitoring